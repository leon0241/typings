const body=document.querySelector("body"),overlay=document.getElementById("overlay"),settingsButton=document.getElementById("settingsButton"),scoresButton=document.getElementById("scoresButton"),game=document.getElementById("game"),gameProgress=game.querySelector("#gameProgress"),gameWordArea=game.querySelector("#gameWordArea"),gameTypingField=game.querySelector("#gameTypingField"),startOverlay=document.getElementById("startOverlay"),finishOverlay=document.getElementById("finishOverlay"),finishForm=finishOverlay.querySelector("#finishForm"),nameInput=finishForm.querySelector("#finishTypingField"),gameWPM=finishForm.querySelector("#gameWPM"),gameAccuracy=finishForm.querySelector("#gameAccuracy"),hiddenWPMInput=finishForm.querySelector("#hiddenWpm"),hiddenAccInput=finishForm.querySelector("#hiddenAcc"),settingsNav=document.getElementById("settingsNav"),wordSelector=settingsNav.querySelector("#wordSelector"),timeSelector=settingsNav.querySelector("#timeSelector"),scoresNav=document.getElementById("scoresNav"),scoreboard=scoresNav.querySelector("#scoreboard"),scorebody=scoreboard.querySelector("#scorebody"),modal=document.getElementById("wordModal"),modalWords=modal.querySelector("#modalWords");let openToggle=!1;function sidebarDOM(button,nav,button2,state){let elementList=[button,nav,overlay];"open"===state?(elementList.forEach(element=>{element.classList.add("open")}),button2.style.zIndex="2"):(elementList.forEach(element=>{element.classList.remove("open")}),button2.style.zIndex="4")}function setTheme(theme){switch(theme){case"light":localStorage.setItem("theme","light"),body.classList.replace("dark","light"),DOMFunctions.theme="light";break;case"dark":body.classList.replace("light","dark"),DOMFunctions.theme="dark",localStorage.setItem("theme","dark")}}function chooseTimeWords(a,b){let group;if(a.classList.add("deselected"),a.querySelectorAll(".lengthRadio").forEach(element=>{element.disabled=!0,element.checked=!1}),b.classList.contains("deselected")){let group;b.classList.remove("deselected"),b.querySelectorAll(".lengthRadio").forEach(element=>{element.disabled=!1})}}function writeWords(arr){modalWords.innerHTML="";for(let i=0;i<arr.length;i++){let appenderSpan=document.createElement("span");appenderSpan.classList.add("modalWord"),appenderSpan.textContent=arr[i],modalWords.appendChild(appenderSpan)}}function sortWordsByLength(){let lengthArr=[];for(let i=0;i<words.length;i++){let element=words[i];lengthArr[i]=[element,element.length]}let sortedArr=insertionSort2d(lengthArr);sortedArr.reverse;let finalArr=[];for(let i=0;i<words.length;i++)finalArr[i]=sortedArr[i][0];return finalArr}function insertionSort2d(list){let max=list.length;for(let i=1;i<max;i++){let j=i;for(;j>0&&list[j-1][1]>list[j][1];){let buffer=list[j-1];list[j-1]=list[j],list[j]=buffer,j--}}return list}function bubbleSort2d(list){let swapped=!0,max=list.length;for(;!0===swapped;){swapped=!1;for(let i=1;i<max;i++)if(list[i-1][1]>list[i][1]){let buffer=list[i-1];list[i-1]=list[i],list[i]=buffer,swapped=!0}}return list}settingsButton.onclick=()=>{!1===openToggle?(sidebarDOM(settingsButton,settingsNav,scoresButton,"open"),openToggle=!0):(sidebarDOM(settingsButton,settingsNav,scoresButton,"close"),openToggle=!1)},scoresButton.onclick=()=>{!1===openToggle?(sidebarDOM(scoresButton,scoresNav,settingsButton,"open"),openToggle=!0):(sidebarDOM(scoresButton,scoresNav,settingsButton,"close"),openToggle=!1)},document.getElementById("lightButton").onclick=()=>{setTheme("light")},document.getElementById("darkButton").onclick=()=>{setTheme("dark")},document.getElementById("startButton").onclick=()=>{DOMFunctions.showBackdrop()},document.getElementById("openModal").onclick=()=>{modal.style.display="flex"},document.getElementById("radiotime").onclick=()=>{chooseTimeWords(wordSelector,timeSelector)},document.getElementById("radiowords").onclick=()=>{chooseTimeWords(timeSelector,wordSelector)},document.getElementById("modalExit").onclick=()=>{modal.style.display="none"},document.getElementById("freqSort").onclick=()=>{let arr;writeWords(words)},document.getElementById("lengthSort").onclick=()=>{let arr;writeWords(sortWordsByLength())},document.getElementById("alphaSort").onclick=()=>{let wordDummy,arr;writeWords([...words].sort((a,b)=>a.toLowerCase().localeCompare(b.toLowerCase())))};class Scoreboard{constructor(){this._scores=[],this._index=0}get strLen(){return this._index.toString()}get scores(){return this._scores}set scores(value){this._scores=value}initIndex(offset){this._index=localStorage.length-offset}addNewScore(value){this._scores.push(value)}submitToLocalStorage(name,wpm){let stat={name:name,wpm:wpm};localStorage.setItem(this.strLen,JSON.stringify(stat)),this._index+=1}parseItem(index){let raw=localStorage.getItem(index.toString()),parsed=JSON.parse(raw),score;return Object.values(parsed)}initScoreboard(){let arr=[],len=this._index;for(let i=0;i<len;i++)arr[i]=this.parseItem(i);let sortedArr=insertionSort2d(arr);sortedArr.reverse(),this._scores=sortedArr,scorebody.innerHTML="";for(let i=0;i<sortedArr.length;i++)this.insertRow(sortedArr[i])}updateScoreboard(){let item=this.parseItem(this._index-1);this.addNewScore(item);let sortedArr=bubbleSort2d(this._scores);sortedArr.reverse(),this.scores=sortedArr,scorebody.innerHTML="";for(let i=0;i<sortedArr.length;i++)this.insertRow(sortedArr[i])}insertRow(array){let newRow=scorebody.insertRow(-1);for(let i=0;i<2;i++){let cell=newRow.insertCell(i),text=document.createTextNode(array[i].toString());cell.appendChild(text)}}}class DOMManipulation{constructor(){this._position=0,this._nodeList=document.querySelectorAll(".typingWord"),this._theme="dark"}get position(){return this._position}get nodeList(){return this._nodeList}get area(){return gameWordArea}get theme(){return this._theme}set position(value){this._position=value}set theme(value){this._theme=value}updateNodeList(){this._nodeList=gameWordArea.querySelectorAll(".typingWord")}updateWords(gameWords,i){let appenderSpan=document.createElement("span");appenderSpan.classList.add("typingWord"),appenderSpan.textContent=`${gameWords[i]} `,gameWordArea.appendChild(appenderSpan)}incrementPosition(){this._position+=1}showArray(gameWords){let area=gameWordArea,nodeItem;area.innerHTML="";for(let i=0;i<50;i++)this.updateWords(gameWords,i);area.querySelector(".typingWord").id="highlightWord",this.updateNodeList()}highlightCurrentWord(){let position=this._position,nodeList=this._nodeList,nodeItem;if(nodeList.item(position).id="highlightWord",position>0){let previousItem=nodeList.item(position-1);if(previousItem.id="previousWord",previousItem.classList.add("completedWord"),position>1){let backItem;nodeList.item(position-2).removeAttribute("id")}}}setAnswer(checkedWord,nodeItem){checkedWord?nodeItem.classList.add("correctWord"):nodeItem.classList.add("wrongWord")}checkRow(){let nodeList,item=this.nodeList.item(this.position),offset;item.offsetTop>item.offsetHeight&&(this.deleteRow(this.position),this.position=0)}deleteRow(position){let nodeList=this._nodeList;for(let i=0;i<position;i++){let selectedSpan;nodeList.item(i).remove()}}displayStats(){let wpm=Game.calculatedStats[0],time=Game.calculatedStats[1];gameWPM.textContent=wpm.toString(),gameAccuracy.textContent=time.toString()}changeGameProgress(value){"number"==typeof value&&(value=value.toString()),gameProgress.textContent=value}showStart(){startOverlay.classList.remove("hide")}showBackdrop(){startOverlay.classList.add("hide")}showFinish(){finishOverlay.style.display="inline",this.displayStats()}hideFinish(){finishOverlay.style.display="none"}appendFormData(){hiddenWPMInput.value=Game._calculatedStats[0].toString(),hiddenAccInput.value=Game._calculatedStats[1].toString()}setSettings(type,length){localStorage.setItem("type",type),localStorage.setItem("length",length),localStorage.setItem("theme",this._theme)}getSettings(){let type,length,theme;return[localStorage.getItem("type"),localStorage.getItem("length"),localStorage.getItem("theme")]}}